# B1.1: Add Limit Picker to "Regenerate Links"

## Implementation Complete ✅

### Summary
Added a limit picker (300/500/1000) to the Regenerate Links dialog, allowing admins to choose how many exercises to process before running the regeneration.

---

## Changes Made

### **workout_knowledge_admin_screen.dart** ✅

**New State Variable:**
- `int _regenLimit = 500;` - Stores the selected limit (default: 500)

**Updated `_regenerateLinks()` Method:**
- Shows dialog with `SegmentedButton` for limit selection (300/500/1000)
- Defaults to current `_regenLimit` value
- Updates stored limit when user confirms
- Uses selected limit when calling service

**Updated Button Tooltip:**
- Dynamic tooltip: `'Regenerate Links (Top $_regenLimit)'`
- Updates when limit changes

---

## UI Flow

1. **User taps refresh button:**
   - Button shows current limit in tooltip (e.g., "Regenerate Links (Top 500)")

2. **Dialog appears:**
   - Title: "Regenerate Exercise-Intensifier Links"
   - SegmentedButton with options: 300, 500 (default), 1000
   - Description text updates dynamically based on selection
   - Cancel and Regenerate buttons

3. **User selects limit:**
   - SegmentedButton updates selection
   - Description text updates to show selected limit
   - Example: "This will add missing links for up to 1000 exercises..."

4. **User confirms:**
   - Stored limit (`_regenLimit`) is updated
   - Button tooltip updates to reflect new limit
   - Service is called with selected limit
   - Existing loading and success dialogs work as before

---

## Features

- **Limit Options:** 300, 500 (default), 1000
- **Persistent Selection:** Limit persists during session (stored in `_regenLimit`)
- **Dynamic UI:** Description text and tooltip update based on selection
- **No Breaking Changes:** Existing RPC and service unchanged
- **Admin-Only:** Button visibility unchanged (admin-only)

---

## Files Modified

1. **lib/screens/admin/workout_knowledge_admin_screen.dart**
   - Added `_regenLimit` state variable (default: 500)
   - Updated `_regenerateLinks()` to show limit picker dialog
   - Updated button tooltip to show current limit
   - Uses `SegmentedButton` for limit selection

---

## Notes

- **Default limit:** 500 (matches RPC default)
- **Limit picker location:** In confirmation dialog (before regeneration)
- **Session persistence:** Limit persists during app session
- **No DB changes:** Pure UI enhancement
- **No service changes:** Uses existing `regenerateExerciseIntensifierLinks()` method

---

## Testing

1. **Test limit selection:**
   - Tap refresh button
   - Select different limits (300/500/1000)
   - Verify description text updates
   - Confirm and verify service is called with correct limit

2. **Test persistence:**
   - Select limit 1000
   - Confirm regeneration
   - Tap refresh button again
   - Verify 1000 is pre-selected

3. **Test default:**
   - Fresh app session
   - Tap refresh button
   - Verify 500 is pre-selected (default)

4. **Test tooltip:**
   - Change limit to 1000
   - Verify button tooltip shows "Regenerate Links (Top 1000)"
